File Structure


mainnet_launch
│   ├── abis

- Stores Contract ABIs and helper methods to determine the proper function signature 


│   ├── accounting

- Holds logic for the top level view of the revenue and expenses of the protocol.
    - Incentive Token Prices
    - Total Autopool Fees and Gas Costs


│   ├── autopool_diagnostics

Descriptions of details specific to each Autopool

### Pages

- Autopool Exposure
Percent and ETH value of Assets held in each Destination over time.
- Autopool CRM
Autopool composite return metic.

The destination weighted avg of composite return out of the autopool and the autopool's underlying destination. Shows the expected performance of our autopool vs the expected performance of the underlying destinations. 



│   ├── constants.py

Onchain addresses for deployed contracts and folder paths. Defines ChainData and AutopoolConstants


│   ├── databases

contains the .db files that hold externally fetched data, such as onchain calls or events.

│   ├── data_fetching

Logic externally fetching:
- contract events eg `strategy_contract.events.RebalanceBetweenDestinations`
- onchain call data eg `WETH.balanceOf(address)`

and

reading and writing processed on-chain data to disk

TODO move this to a separate folder maybe in the databases folder?


├── add_info_to_dataframes.py
├── get_events.py
├── get_state_by_block.py
├── new_databases.py


│   ├── destination_diagnostics

Destination specific on chain calls `getDestinationSummaryStats()`


│   ├── destinations.py

A "Destination" is some unique onchain location where assets are deployed to earn yield. 
This contains functions to get all destinations for each autopool. 

They cannot be hard coded because destinations are added and removed over time

│   ├── gas_costs

Logic for the gas costs for the chainlink keeper network

│   ├── lens_contract.py

Calls to the Autopool Lens contract


│   ├── main.py

The main file of the streamlit app

│   ├── notebooks

Place to keep old working notebooks in case they could be helpful later. 


│   ├── page_functions.py

Defines the page names and what function is called when going to that page

│   ├── rebalance_plans

Holds the rebalance plans jsons generated by the solver. As of Jan 8 has 1,597 items, totalling 38.2 MB


│   ├── setup_databases.py

Ran once at the start of the app. Ensures the databases exist and fetches and saves data up to the current day.

│   ├── solver_diagnostics

Fetches rebalance events, renders charts related to the solver


│   ├── test_pages.py

Helper method to test that no changes broke the app. `poetry run test-pages` opens up 'test-pages.log' in vs code and goes through each page and each autopool sequentially. 


│   ├── tests

pytest tests that are run in the github CI. Currently makes sure that the s3 buckets are correct and Alchemy keys can fetch data.


│   ├── top_level

The key metrics page



│   ├── ui_config_setup.py

Configuration details for plotly and streamlit. 


│   └── working_data

Ignored by git for adhoc notebooks and scripts.


├── poetry.lock
├── production_usage.log

├── pyproject.toml
├── README.md
├── test_pages.log
└── tests
    ├── __init__.py
    ├── mock_test.py
    └── test_buckets.py


